


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > Element</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">kweb</a>
</div>

<h1>Coverage Summary for Class: Element (kweb)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
<th class="coverageStat 
">
  Instruction, %
</th>
</tr>
<tr>
  <td class="name">Element</td>
<td class="coverageStat">
  <span class="percent">
    31.7%
  </span>
  <span class="absValue">
    (19/60)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    30.2%
  </span>
  <span class="absValue">
    (26/86)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    41.8%
  </span>
  <span class="absValue">
    (82/196)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    40%
  </span>
  <span class="absValue">
    (540/1349)
  </span>
</td>
</tr>
  <tr>
    <td class="name">Element$addEventListener$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (8/8)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$addEventListener$2</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (6/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$addEventListener$eventObject$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (4/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$bind$$inlined$event$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">Element$bind$$inlined$event$1$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">Element$bind$$inlined$event$1$2</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">Element$bind$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (5/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$bind$2</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (6/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$bind$4</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (15/15)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$bind$kvChangeHandler$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (20/20)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$classes$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$flags$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$innerHTML$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$innerHTML$handle$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$set$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$set$handle$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$text$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Element$text$handle$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    34.7%
  </span>
  <span class="absValue">
    (26/75)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    31.8%
  </span>
  <span class="absValue">
    (28/88)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    42.7%
  </span>
  <span class="absValue">
    (91/213)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    41.7%
  </span>
  <span class="absValue">
    (604/1450)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package kweb
&nbsp;
&nbsp;import kotlinx.serialization.json.*
&nbsp;import kweb.WebBrowser.CatcherType.RENDER
&nbsp;import kweb.html.events.Event
&nbsp;import kweb.html.events.EventGenerator
&nbsp;import kweb.html.events.OnImmediateReceiver
&nbsp;import kweb.html.events.OnReceiver
&nbsp;import kweb.html.style.StyleReceiver
&nbsp;import kweb.plugins.KwebPlugin
&nbsp;import kweb.state.CloseReason
&nbsp;import kweb.state.KVal
&nbsp;import kweb.state.KVar
&nbsp;import kweb.util.KWebDSL
&nbsp;import kweb.util.json
&nbsp;import kweb.util.random
&nbsp;import java.util.concurrent.ConcurrentSkipListSet
&nbsp;import kotlin.math.abs
&nbsp;import kotlin.reflect.KClass
&nbsp;
&nbsp;/**
&nbsp; * Represents a [DOM Element](https://www.w3schools.com/jsref/dom_obj_all.asp) in a
&nbsp; * remote browser window.
&nbsp; */
&nbsp;
<b class="fc">&nbsp;@KWebDSL</b>
&nbsp;open class Element(
<b class="fc">&nbsp;    override val browser: WebBrowser,</b>
<b class="fc">&nbsp;    val creator: ElementCreator&lt;*&gt;?,</b>
<b class="fc">&nbsp;    val tag: String? = null,</b>
<b class="fc">&nbsp;    @Volatile var id: String</b>
&nbsp;) :
&nbsp;    EventGenerator&lt;Element&gt; {
<b class="fc">&nbsp;    constructor(element: Element) : this(element.browser, element.creator, tag = element.tag, id = element.id)</b>
&nbsp;
&nbsp;    /*********
&nbsp;     ********* Utilities for plugin creators
&nbsp;     *********/
&nbsp;    /**
&nbsp;     * Requires that a specific plugin or plugins be loaded by listing them
&nbsp;     * in the `plugins` parameter of the [Kweb] constructor.
&nbsp;     *
&nbsp;     * This should be called by any function that requires a particular plugin or
&nbsp;     * plugins be present.
&nbsp;     */
<b class="nc">&nbsp;    fun assertPluginLoaded(vararg plugins: KClass&lt;out KwebPlugin&gt;) = browser.require(*plugins)</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Obtain the instance of a plugin by its [KClass].
&nbsp;     */
&nbsp;    // TODO: Does this prevent the use of multiple plugins of the same class?
<b class="nc">&nbsp;    fun &lt;P : KwebPlugin&gt; plugin(plugin: KClass&lt;P&gt;) = browser.plugin(plugin)</b>
&nbsp;
&nbsp;    /*********
&nbsp;     ********* Utilities for modifying this element
&nbsp;     *********/
&nbsp;
&nbsp;    /**
&nbsp;     * A utility function to set multiple attributes in a single call, in the
&nbsp;     * style of [mapOf]. This is a wrapper around [set].
&nbsp;     */
&nbsp;    fun setAttributes(vararg pair: Pair&lt;String, JsonPrimitive&gt;): Element {
<b class="nc">&nbsp;        pair.forEach { (k, v) -&gt; set(k, v) }</b>
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Set an attribute of this element.  For example `a().setAttribute(&quot;href&quot;, &quot;http://kweb.io&quot;)`
&nbsp;     * will create an `&lt;a&gt;` element and set it to `&lt;a href=&quot;http://kweb.io/&quot;&gt;`.
&nbsp;     */
<b class="fc">&nbsp;    operator fun set(name: String, value: JsonPrimitive) = set(name, value, null)</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Set an attribute of this element.  For example `element[&quot;href&quot;] = &quot;http://kweb.io&quot;`
&nbsp;     * will create an `&lt;a&gt;` element and set it to `&lt;a href=&quot;http://kweb.io/&quot;&gt;`.
&nbsp;     *
&nbsp;     * @param namespace If non-null elements will be created with [Element.setAttributeNS()](https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttributeNS)
&nbsp;     *                  with the specified namespace. If null then Kweb will use [Element.createElement](https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute).
&nbsp;
&nbsp;     */
<b class="nc">&nbsp;    fun set(name: String, value: JsonPrimitive, namespace: String? = null): Element {</b>
<b class="fc">&nbsp;        val jsoupDoc = browser.htmlDocument.get()</b>
<b class="fc">&nbsp;        val setAttributeJavaScript = when (namespace) {</b>
<b class="pc">&nbsp;            null -&gt; &quot;document.getElementById({}).setAttribute({}, {});&quot;</b>
<b class="nc">&nbsp;            else -&gt; &quot;document.getElementById({}).setAttributeNS(\&quot;$namespace\&quot;, {}, {});&quot;</b>
&nbsp;        }
<b class="fc">&nbsp;        when {</b>
<b class="pc">&nbsp;            jsoupDoc != null &amp;&amp; (browser.isCatchingOutbound() == null || browser.isCatchingOutbound() == RENDER) -&gt; {</b>
<b class="fc">&nbsp;                jsoupDoc.getElementById(this.id)!!.attr(name, value.content)</b>
&nbsp;            }
&nbsp;
&nbsp;            else -&gt; {
<b class="fc">&nbsp;                browser.callJsFunction(</b>
<b class="fc">&nbsp;                    setAttributeJavaScript,</b>
<b class="fc">&nbsp;                    id.json, name.json, value</b>
&nbsp;                )
&nbsp;            }
&nbsp;        }
<b class="pc">&nbsp;        if (name.equals(&quot;id&quot;, ignoreCase = true)) {</b>
<b class="nc">&nbsp;            this.id = value.toString()</b>
&nbsp;        }
<b class="fc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    operator fun set(name: String, value: String) = set(name, JsonPrimitive(value))</b>
&nbsp;
<b class="nc">&nbsp;    operator fun set(name: String, value: Boolean) = set(name, JsonPrimitive(value))</b>
&nbsp;
<b class="nc">&nbsp;    operator fun set(name: String, value: Number) = set(name, JsonPrimitive(value))</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Set an attribute to the value in a [KVal], if the value changes the attribute
&nbsp;     * value will be updated automatically.
&nbsp;     */
&nbsp;    operator fun set(name: String, value: KVal&lt;out JsonPrimitive&gt;): Element {
<b class="nc">&nbsp;        set(name, value.value)</b>
<b class="nc">&nbsp;        val handle = value.addListener { _, newValue -&gt;</b>
<b class="nc">&nbsp;            set(name, newValue)</b>
&nbsp;        }
<b class="nc">&nbsp;        this.creator?.onCleanup(true) {</b>
<b class="nc">&nbsp;            value.removeListener(handle)</b>
&nbsp;        }
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Set an attribute of this element.  For example `a().setAttribute(&quot;href&quot;, &quot;http://kweb.io&quot;)`
&nbsp;     * will create an `&lt;a&gt;` element and set it to `&lt;a href=&quot;http://kweb.io/&quot;&gt;`.
&nbsp;     *
&nbsp;     * @param namespace If non-null elements will be created with [Element.setAttributeNS()](https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttributeNS)
&nbsp;     *                  with the specified namespace. If null then Kweb will use [Element.createElement](https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute).
&nbsp;
&nbsp;     */
&nbsp;    @Deprecated(&quot;Use set() instead&quot;, ReplaceWith(&quot;set(name, value, namespace)&quot;))
<b class="nc">&nbsp;    fun setAttribute(name: String, value: JsonPrimitive, namespace: String? = null): Element {</b>
<b class="nc">&nbsp;        return set(name, value, namespace)</b>
&nbsp;    }
&nbsp;
&nbsp;    @Deprecated(&quot;use set() instead&quot;, replaceWith = ReplaceWith(expression = &quot;set(name, value)&quot;))
<b class="nc">&nbsp;    fun setAttributeRaw(name: String, value: JsonPrimitive) = set(name, value)</b>
&nbsp;
&nbsp;    @Deprecated(&quot;use set() instead&quot;, replaceWith = ReplaceWith(expression = &quot;set(name, value)&quot;))
<b class="nc">&nbsp;    fun setAttributeRaw(name: String, value: String) = set(name, JsonPrimitive(value))</b>
&nbsp;
&nbsp;    @Deprecated(&quot;use set() instead&quot;, replaceWith = ReplaceWith(expression = &quot;set(name, value)&quot;))
<b class="nc">&nbsp;    fun setAttributeRaw(name: String, value: Boolean) = set(name, JsonPrimitive(value))</b>
&nbsp;
&nbsp;    @Deprecated(&quot;use set() instead&quot;, replaceWith = ReplaceWith(expression = &quot;set(name, value)&quot;))
<b class="nc">&nbsp;    fun setAttributeRaw(name: String, value: Number) = set(name, JsonPrimitive(value))</b>
&nbsp;
&nbsp;    @Deprecated(&quot;use set() instead&quot;, replaceWith = ReplaceWith(expression = &quot;set(name, value)&quot;))
<b class="nc">&nbsp;    fun setAttribute(name: String, value: String) = set(name, JsonPrimitive(value))</b>
&nbsp;
&nbsp;    @Deprecated(&quot;use set() instead&quot;, replaceWith = ReplaceWith(expression = &quot;set(name, value)&quot;))
<b class="nc">&nbsp;    fun setAttribute(name: String, value: Boolean) = set(name, JsonPrimitive(value))</b>
&nbsp;
&nbsp;    @Deprecated(&quot;use set() instead&quot;, replaceWith = ReplaceWith(expression = &quot;set(name, value)&quot;))
<b class="nc">&nbsp;    fun setAttribute(name: String, value: Number) = set(name, JsonPrimitive(value))</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Set an attribute to the value in a [KVal], if the value changes the attribute
&nbsp;     * value will be updated automatically.
&nbsp;     */
&nbsp;    @Deprecated(&quot;use set() instead&quot;, replaceWith = ReplaceWith(expression = &quot;set(name, value)&quot;))
<b class="nc">&nbsp;    fun setAttribute(name: String, value: KVal&lt;out JsonPrimitive&gt;) = set(name, value)</b>
&nbsp;
&nbsp;    fun removeAttribute(name: String): Element {
<b class="nc">&nbsp;        val jsoupDoc = browser.htmlDocument.get()</b>
<b class="nc">&nbsp;        when {</b>
<b class="nc">&nbsp;            jsoupDoc != null &amp;&amp; (browser.isCatchingOutbound() == null || browser.isCatchingOutbound() == RENDER) -&gt; {</b>
<b class="nc">&nbsp;                jsoupDoc.getElementById(id)!!.removeAttr(name)</b>
&nbsp;            }
&nbsp;
&nbsp;            else -&gt; {
<b class="nc">&nbsp;                browser.callJsFunction(&quot;document.getElementById({}).removeAttribute({})&quot;, id.json, JsonPrimitive(name))</b>
&nbsp;            }
&nbsp;
&nbsp;        }
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Sets the [innerHTML](https://www.w3schools.com/jsref/prop_html_innerhtml.asp) property
&nbsp;     * of a DOM element.
&nbsp;     */
&nbsp;    fun innerHTML(html: String): Element {
<b class="fc">&nbsp;        val jsoupDoc = browser.htmlDocument.get()</b>
<b class="fc">&nbsp;        when {</b>
<b class="pc">&nbsp;            jsoupDoc != null &amp;&amp; (browser.isCatchingOutbound() == null || browser.isCatchingOutbound() == RENDER) -&gt; {</b>
<b class="fc">&nbsp;                val thisEl = jsoupDoc.getElementById(this.id)!!</b>
<b class="fc">&nbsp;                thisEl.html(html)</b>
&nbsp;            }
&nbsp;
&nbsp;            else -&gt; {
<b class="nc">&nbsp;                browser.callJsFunction(&quot;document.getElementById({}).innerHTML = {}&quot;, id.json, JsonPrimitive(html))</b>
&nbsp;            }
&nbsp;        }
<b class="fc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Sets the [innerHTML](https://www.w3schools.com/jsref/prop_html_innerhtml.asp) property
&nbsp;     * of a DOM element. This will be updated automatically if the value of [html] changes.
&nbsp;     */
&nbsp;    fun innerHTML(html: KVal&lt;String&gt;): Element {
<b class="nc">&nbsp;        this.innerHTML(html.value)</b>
<b class="nc">&nbsp;        val handle = html.addListener { _, new -&gt;</b>
<b class="nc">&nbsp;            innerHTML(new)</b>
&nbsp;        }
<b class="nc">&nbsp;        this.creator?.onCleanup(true) {</b>
<b class="nc">&nbsp;            html.removeListener(handle)</b>
&nbsp;        }
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    fun focus(): Element {
<b class="nc">&nbsp;        browser.callJsFunction(&quot;document.getElementById({}).focus();&quot;, id.json)</b>
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    fun blur(): Element {
<b class="nc">&nbsp;        browser.callJsFunction(&quot;document.getElementById({}).blur();&quot;, id.json)</b>
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * A convenience function to set the [class attribute](https://www.w3schools.com/html/html_classes.asp),
&nbsp;     * this is a wrapper around [setAttribute].
&nbsp;     */
<b class="nc">&nbsp;    fun classes(value: KVal&lt;String&gt;) = set(&quot;class&quot;, value.map { it.json })</b>
&nbsp;
&nbsp;    /**
&nbsp;     * A convenience function to set the [class attribute](https://www.w3schools.com/html/html_classes.asp),
&nbsp;     * this is a wrapper around [set].
&nbsp;     */
<b class="fc">&nbsp;    fun classes(vararg value: String) = setClasses(*value)</b>
&nbsp;
&nbsp;    /**
&nbsp;     * A convenience function to set the [class attribute](https://www.w3schools.com/html/html_classes.asp),
&nbsp;     * this is a wrapper around [setAttribute].
&nbsp;     */
&nbsp;    fun setClasses(vararg value: String): Element {
<b class="fc">&nbsp;        set(&quot;class&quot;, value.joinToString(separator = &quot; &quot;).json)</b>
<b class="fc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * A convenience function to append a class to an existing [class attribute](https://www.w3schools.com/html/html_classes.asp).
&nbsp;     */
<b class="nc">&nbsp;    fun addClasses(vararg classes: String, onlyIf: Boolean = true): Element {</b>
<b class="nc">&nbsp;        if (onlyIf) {</b>
<b class="nc">&nbsp;            val jsoupDoc = browser.htmlDocument.get()</b>
<b class="nc">&nbsp;            when {</b>
<b class="nc">&nbsp;                jsoupDoc != null &amp;&amp; (browser.isCatchingOutbound() == null || browser.isCatchingOutbound() == RENDER) -&gt; {</b>
<b class="nc">&nbsp;                    val thisEl = jsoupDoc.getElementById(this.id)!!</b>
<b class="nc">&nbsp;                    classes.forEach { thisEl.addClass(it) }</b>
&nbsp;                }
&nbsp;
&nbsp;                else -&gt; {
<b class="nc">&nbsp;                    for (class_ in classes) {</b>
<b class="nc">&nbsp;                        if (class_.contains(&#39; &#39;)) {</b>
<b class="nc">&nbsp;                            error(&quot;Class names must not contain spaces&quot;)</b>
&nbsp;                        }
&nbsp;                        //language=JavaScript
<b class="nc">&nbsp;                        browser.callJsFunction(</b>
&nbsp;                            &quot;&quot;&quot;
&nbsp;                                    let id = {};
&nbsp;                                    let className = {};
&nbsp;                                    let el = document.getElementById(id);
&nbsp;                                    if (el.classList) el.classList.add(className);
&nbsp;                                    else if (!hasClass(el, className)) el.className += &quot; &quot; + className;
<b class="nc">&nbsp;                                &quot;&quot;&quot;.trimIndent(), id.json, JsonPrimitive(class_)</b>
&nbsp;                        )
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;
&nbsp;        }
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * A convenience function to remove one or more classes from an existing
&nbsp;     * [class attribute](https://www.w3schools.com/html/html_classes.asp). This will
&nbsp;     * be ignored if [onlyIf] is false.
&nbsp;     */
<b class="nc">&nbsp;    fun removeClasses(vararg classes: String, onlyIf: Boolean = true): Element {</b>
<b class="nc">&nbsp;        if (onlyIf) {</b>
<b class="nc">&nbsp;            for (class_ in classes) {</b>
<b class="nc">&nbsp;                if (class_.contains(&#39; &#39;)) {</b>
<b class="nc">&nbsp;                    error(&quot;Class names must not contain spaces&quot;)</b>
&nbsp;                }
&nbsp;                //language=JavaScript
<b class="nc">&nbsp;                browser.callJsFunction(</b>
&nbsp;                    &quot;&quot;&quot;
&nbsp;                            let id = {};
&nbsp;                            let className = {};
&nbsp;                            let el = document.getElementById(id);
&nbsp;                            if (el.classList) el.classList.remove(className);
&nbsp;                            else if (hasClass(el, className)) {
&nbsp;                                var reg = new RegExp(&quot;(\\s|^)&quot; + className + &quot;(\\s|${&#39;$&#39;})&quot;);
&nbsp;                                el.className = el.className.replace(reg, &quot; &quot;);
&nbsp;                            }
<b class="nc">&nbsp;                        &quot;&quot;&quot;.trimIndent(), id.json, JsonPrimitive(class_)</b>
&nbsp;                )
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    fun activate(): Element {
<b class="nc">&nbsp;        addClasses(&quot;is-active&quot;)</b>
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    fun deactivate(): Element {
<b class="nc">&nbsp;        removeClasses(&quot;is-active&quot;)</b>
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    fun disable(): Element {
<b class="nc">&nbsp;        set(&quot;disabled&quot;, JsonPrimitive(true))</b>
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    fun enable(): Element {
<b class="nc">&nbsp;        removeAttribute(&quot;disabled&quot;)</b>
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    fun removeChildren(): Element {
<b class="nc">&nbsp;        val jsoupDoc = browser.htmlDocument.get()</b>
<b class="nc">&nbsp;        when {</b>
<b class="nc">&nbsp;            jsoupDoc != null &amp;&amp; (browser.isCatchingOutbound() == null || browser.isCatchingOutbound() == RENDER) -&gt; {</b>
<b class="nc">&nbsp;                val jsoupElement = jsoupDoc.getElementById(this.id)</b>
<b class="nc">&nbsp;                jsoupElement!!.children().remove()</b>
&nbsp;            }
&nbsp;
&nbsp;            else -&gt; {
&nbsp;                //language=JavaScript
<b class="nc">&nbsp;                browser.callJsFunction(</b>
&nbsp;                    &quot;&quot;&quot;
&nbsp;                            let id = {};
&nbsp;                            if (document.getElementById(id) != null) {
&nbsp;                                let element = document.getElementById(id);
&nbsp;                                while (element.firstChild) {
&nbsp;                                    element.removeChild(element.firstChild);
&nbsp;                                }
&nbsp;                            }
<b class="nc">&nbsp;                        &quot;&quot;&quot;.trimIndent(), id.json</b>
&nbsp;                )
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    fun removeChildrenBetweenSpans(startSpanId: String, endSpanId: String): Element {
<b class="fc">&nbsp;        val jsoupDoc = browser.htmlDocument.get()</b>
<b class="fc">&nbsp;        when {</b>
<b class="pc">&nbsp;            jsoupDoc != null &amp;&amp; (browser.isCatchingOutbound() == null || browser.isCatchingOutbound() == RENDER) -&gt; {</b>
&nbsp;                //TODO this will only run during initial page render, and is currently untested.
<b class="fc">&nbsp;                jsoupDoc.getElementById(this.id).let { jsoupElement -&gt;</b>
<b class="fc">&nbsp;                    val startSpan = jsoupElement!!.getElementById(startSpanId)</b>
<b class="fc">&nbsp;                    val endSpan = jsoupElement.getElementById(endSpanId)</b>
<b class="fc">&nbsp;                    var nextSibling = startSpan!!.nextElementSibling()</b>
<b class="pc">&nbsp;                    while (nextSibling != endSpan) {</b>
<b class="nc">&nbsp;                        nextSibling!!.remove()</b>
<b class="nc">&nbsp;                        nextSibling = startSpan.nextElementSibling()</b>
&nbsp;                    }
<b class="fc">&nbsp;                }</b>
&nbsp;            }
&nbsp;
&nbsp;            else -&gt; {
&nbsp;                //language=JavaScript
<b class="fc">&nbsp;                browser.callJsFunction(</b>
&nbsp;                    &quot;&quot;&quot;
&nbsp;                            let startSpan = document.getElementById({});
&nbsp;                            let endSpan = document.getElementById({});
&nbsp;                            let nextSibling = startSpan.nextSibling;
&nbsp;                            while(nextSibling != endSpan) {
&nbsp;                                startSpan.parentNode.removeChild(startSpan.nextSibling);
&nbsp;                                nextSibling = startSpan.nextSibling;
&nbsp;                            }
<b class="fc">&nbsp;                        &quot;&quot;&quot;.trimIndent(), JsonPrimitive(startSpanId), JsonPrimitive(endSpanId)</b>
&nbsp;                )
&nbsp;            }
&nbsp;        }
<b class="fc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    fun removeChildAt(position: Int): Element {
<b class="nc">&nbsp;        val jsoupDoc = browser.htmlDocument.get()</b>
<b class="nc">&nbsp;        when {</b>
<b class="nc">&nbsp;            jsoupDoc != null &amp;&amp; (browser.isCatchingOutbound() == null || browser.isCatchingOutbound() == RENDER) -&gt; {</b>
<b class="nc">&nbsp;                jsoupDoc</b>
<b class="nc">&nbsp;                    .getElementById(this.id)!!</b>
<b class="nc">&nbsp;                    .children()[position]</b>
<b class="nc">&nbsp;                    .remove()</b>
&nbsp;            }
&nbsp;
&nbsp;            else -&gt; {
<b class="nc">&nbsp;                browser.callJsFunction(</b>
&nbsp;                    &quot;&quot;&quot;
&nbsp;                                let element = document.getElementById({});
&nbsp;                                element.removeChild(element.children[{}]);
<b class="nc">&nbsp;                        &quot;&quot;&quot;.trimIndent(), id.json, position.json</b>
&nbsp;                )
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Set the text of this element to `value`.  Eg. `h1().text(&quot;Hello World&quot;)` will create
&nbsp;     * a `h1` element and set its text as follows: `&lt;h1&gt;Hello World&lt;/h1&gt;`.
&nbsp;     */
&nbsp;    fun text(value: String): Element {
<b class="fc">&nbsp;        val jsoupDoc = browser.htmlDocument.get()</b>
&nbsp;        //language=JavaScript
<b class="fc">&nbsp;        val setTextJS = &quot;&quot;&quot;document.getElementById({}).textContent = {};&quot;&quot;&quot;.trimIndent()</b>
<b class="fc">&nbsp;        when {</b>
<b class="fc">&nbsp;            jsoupDoc != null &amp;&amp; (browser.isCatchingOutbound() == null || browser.isCatchingOutbound() == RENDER) -&gt; {</b>
<b class="fc">&nbsp;                val element = jsoupDoc.getElementById(this.id)</b>
<b class="fc">&nbsp;                element!!.text(value)</b>
&nbsp;            }
&nbsp;
&nbsp;            else -&gt; {
<b class="fc">&nbsp;                browser.callJsFunction(setTextJS, id.json, JsonPrimitive(value))</b>
&nbsp;            }
&nbsp;        }
<b class="fc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Set the text of this element to an [KVal] value.  If the text in the KVal
&nbsp;     * changes the text of this element will update automatically.
&nbsp;     */
&nbsp;    fun text(text: KVal&lt;String&gt;): Element {
<b class="nc">&nbsp;        this.text(text.value)</b>
<b class="nc">&nbsp;        val handle = text.addListener { _, new -&gt;</b>
<b class="nc">&nbsp;            text(new)</b>
&nbsp;        }
<b class="nc">&nbsp;        this.creator?.onCleanup(true) {</b>
<b class="nc">&nbsp;            text.removeListener(handle)</b>
&nbsp;        }
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    var text: KVar&lt;String&gt;
&nbsp;        get() {
<b class="nc">&nbsp;            val t = KVar(&quot;&quot;)</b>
<b class="nc">&nbsp;            text(t)</b>
<b class="nc">&nbsp;            return t</b>
&nbsp;        }
&nbsp;        set(nv) {
<b class="nc">&nbsp;            text(nv)</b>
&nbsp;        }
&nbsp;
&nbsp;    fun addText(value: String): Element {
<b class="nc">&nbsp;        val jsoupDoc = browser.htmlDocument.get()</b>
&nbsp;        //language=JavaScript
<b class="nc">&nbsp;        val createTextNodeJs = &quot;&quot;&quot;</b>
&nbsp;            var ntn = document.createTextNode({});
&nbsp;            document.getElementById({}).appendChild(ntn);
<b class="nc">&nbsp;        &quot;&quot;&quot;.trimIndent()</b>
<b class="nc">&nbsp;        when {</b>
<b class="nc">&nbsp;            jsoupDoc != null &amp;&amp; (browser.isCatchingOutbound() == null || browser.isCatchingOutbound() == RENDER) -&gt; {</b>
<b class="nc">&nbsp;                val element = jsoupDoc.getElementById(this.id)</b>
<b class="nc">&nbsp;                element!!.appendText(value)</b>
&nbsp;            }
&nbsp;
&nbsp;            else -&gt; {
<b class="nc">&nbsp;                browser.callJsFunction(createTextNodeJs, JsonPrimitive(value), id.json)</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    override fun addImmediateEventCode(eventName: String, jsCode: String) {
&nbsp;        //language=JavaScript
<b class="fc">&nbsp;        val wrappedJS = &quot;&quot;&quot;</b>
&nbsp;            return document.getElementById({}).addEventListener({}, function(event) {
<b class="fc">&nbsp;                $jsCode</b>
<b class="fc">&nbsp;            });&quot;&quot;&quot;.trimIndent()</b>
<b class="fc">&nbsp;        browser.callJsFunction(wrappedJS, id.json, JsonPrimitive(eventName))</b>
&nbsp;    }
&nbsp;
&nbsp;    override fun addEventListener(
&nbsp;        eventName: String,
&nbsp;        returnEventFields: Set&lt;String&gt;,
&nbsp;        retrieveJs: String?,
&nbsp;        preventDefault: Boolean,
&nbsp;        callback: (JsonElement) -&gt; Unit
&nbsp;    ): Element {
<b class="fc">&nbsp;        val callbackId = abs(random.nextInt())</b>
<b class="fc">&nbsp;        val retrievedJs = if (retrieveJs != null) &quot;, \&quot;retrieved\&quot; : ($retrieveJs)&quot; else &quot;&quot;</b>
<b class="fc">&nbsp;        val eventObject =</b>
<b class="fc">&nbsp;            &quot;{&quot; + returnEventFields.joinToString(separator = &quot;, &quot;) { &quot;\&quot;$it\&quot; : event.$it&quot; } + retrievedJs + &quot;}&quot;</b>
&nbsp;        /*It&#39;d be nice to make eventObject a parameter, but it doesn&#39;t work.
&nbsp;            eventObject is a map that has entries that look like { &quot;buttons&quot; : event.buttons }
&nbsp;            the event field accessed here is the event parameter from the &quot;function(event)&quot; in the javascript
&nbsp;            There is no way to reference that event object from the server, so we use eventObject, and insert properly
&nbsp;            formatted JavaScript directly in the code sent to the client.
&nbsp;        */
<b class="fc">&nbsp;        val addEventJs = &quot;&quot;&quot;</b>
&nbsp;            document.getElementById({}).addEventListener({}, function(event) {
<b class="fc">&nbsp;                ${if (preventDefault) &quot;event.preventDefault();&quot; else &quot;&quot;}</b>
<b class="fc">&nbsp;                callbackWs({}, $eventObject);</b>
&nbsp;            });
&nbsp;            return true;
<b class="fc">&nbsp;        &quot;&quot;&quot;.trimIndent()</b>
&nbsp;        //Adding event listener was causing the client to send a Client2ServerMessage with a null data field. This caused an error
&nbsp;        //We make the client return true to avoid that issue.
&nbsp;        //Then on the server we only invoke our callback on eventObjects, by checking that payload is a JsonObject.
&nbsp;        //TODO we may want to fix this issue. It will probably require adding a new parameter to Server2ClientMessage
&nbsp;        //that will tell the client to run addEventJs, without expecting a return.
<b class="fc">&nbsp;        browser.callJsFunctionWithCallback(addEventJs, callbackId, callback = { payload -&gt;</b>
<b class="fc">&nbsp;            if (payload is JsonObject) {</b>
<b class="fc">&nbsp;                callback.invoke(payload)</b>
&nbsp;            }
<b class="fc">&nbsp;        }, id.json, JsonPrimitive(eventName), JsonPrimitive(callbackId))</b>
<b class="pc">&nbsp;        this.creator?.onCleanup(true) {</b>
<b class="fc">&nbsp;            browser.removeCallback(callbackId)</b>
&nbsp;        }
<b class="fc">&nbsp;        return this</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Return a KVar that is tied to a property related to an element, which will update when an specified
&nbsp;     * event fires on this element. This is a convenience wrapper around [bind].
&nbsp;     *
&nbsp;     * @param accessor Function that takes an element id and returns a JavaScript expression to access that element
&nbsp;     * @param updateOnEvent The event to listen for that signifies this element has been updated
&nbsp;     * @param initialValue The initial value of the KVar
&nbsp;     */
<b class="nc">&nbsp;    fun bind(</b>
&nbsp;        accessor: (elementId: String) -&gt; String,
&nbsp;        updateOnEvent: String,
<b class="nc">&nbsp;        initialValue: JsonElement = JsonPrimitive(&quot;&quot;)</b>
&nbsp;    ): KVar&lt;JsonElement&gt; {
<b class="fc">&nbsp;        return bind(</b>
<b class="fc">&nbsp;            reader = { accessor(it) },</b>
<b class="fc">&nbsp;            writer = { id, value -&gt; &quot;${accessor(id)} = $value&quot; },</b>
<b class="fc">&nbsp;            updateOnEvent = updateOnEvent,</b>
<b class="fc">&nbsp;            initialValue = initialValue</b>
&nbsp;        )
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Return a KVar that is tied to a property related to an element, which will update when an specified
&nbsp;     * event fires on this element.
&nbsp;     *
&nbsp;     * @param reader Function that takes an element id and returns a JavaScript expression to read that element
&nbsp;     * @param writer Function that takes an element id and a new value, and returns a JavaScript expression to
&nbsp;     *               write that value.
&nbsp;     * @param updateOnEvent The event to listen for that signifies this element has been updated
&nbsp;     * @param initialValue The initial value of the KVar
&nbsp;     */
<b class="nc">&nbsp;    fun bind(</b>
&nbsp;        reader: (elementId: String) -&gt; String,
&nbsp;        writer: (elementId: String, value: String) -&gt; String,
&nbsp;        updateOnEvent: String,
<b class="nc">&nbsp;        initialValue: JsonElement = JsonPrimitive(&quot;&quot;)</b>
&nbsp;    ): KVar&lt;JsonElement&gt; {
<b class="fc">&nbsp;        val kv = KVar(initialValue)</b>
<b class="fc">&nbsp;        on(retrieveJs = reader(this.id)).event&lt;Event&gt;(updateOnEvent) { event -&gt;</b>
<b class="fc">&nbsp;            kv.value = event.retrieved</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        val kvChangeHandler = kv.addListener { _, new -&gt;</b>
<b class="fc">&nbsp;            browser.callJsFunction(writer(this.id, &quot;{}&quot;) + &quot;;&quot;, new)</b>
&nbsp;        }
<b class="pc">&nbsp;        creator?.onCleanup(true) {</b>
<b class="fc">&nbsp;            kv.removeListener(kvChangeHandler)</b>
<b class="fc">&nbsp;            kv.close(CloseReason(&quot;Ancestor ElementCreator cleaned up&quot;))</b>
&nbsp;        }
<b class="fc">&nbsp;        browser.callJsFunction(writer(this.id, &quot;{}&quot;) + &quot;;&quot;, initialValue)</b>
<b class="fc">&nbsp;        return kv</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Remove this element by calling [removeChild](https://developer.mozilla.org/en-US/docs/Web/API/Node/removeChild)
&nbsp;     * on its parent element. An error will occur in the browser if the element doesn&#39;t exist.
&nbsp;     */
&nbsp;    fun delete() {
&nbsp;        //language=JavaScript
<b class="nc">&nbsp;        browser.callJsFunction(</b>
&nbsp;            &quot;&quot;&quot;
&nbsp;            let element = document.getElementById({});
&nbsp;            element.parentNode.removeChild(element);
<b class="nc">&nbsp;        &quot;&quot;&quot;.trimIndent(), id.json</b>
&nbsp;        )
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Remove this element by calling [removeChild](https://developer.mozilla.org/en-US/docs/Web/API/Node/removeChild)
&nbsp;     * on its parent element if it exists.
&nbsp;     */
&nbsp;    fun deleteIfExists() {
<b class="fc">&nbsp;        try {</b>
&nbsp;            //language=JavaScript
<b class="fc">&nbsp;            browser.callJsFunction(</b>
&nbsp;                &quot;&quot;&quot;
&nbsp;                let id = {}
&nbsp;                if (document.getElementById(id)) {
&nbsp;                    let element = document.getElementById(id);
&nbsp;                    element.parentNode.removeChild(element);
&nbsp;                }
<b class="fc">&nbsp;            &quot;&quot;&quot;.trimIndent(), id.json</b>
&nbsp;            )
<b class="nc">&nbsp;        } catch (e: IllegalStateException) {</b>
&nbsp;
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Determines whether this element will be [spellchecked](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/spellcheck).
&nbsp;     */
<b class="nc">&nbsp;    fun spellcheck(spellcheck: Boolean = true) = set(&quot;spellcheck&quot;, JsonPrimitive(spellcheck))</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Some convenience functions for modifying an element&#39;s [style attribute](https://www.w3schools.com/tags/att_style.asp).
&nbsp;     */
<b class="nc">&nbsp;    val style get() = StyleReceiver(this)</b>
&nbsp;
<b class="pc">&nbsp;    val flags: ConcurrentSkipListSet&lt;String&gt; by lazy { ConcurrentSkipListSet() }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * See [here](https://docs.kweb.io/en/latest/dom.html#listening-for-events).
&nbsp;     */
<b class="fc">&nbsp;    val on: OnReceiver&lt;Element&gt; get() = OnReceiver(this, preventDefault = false)</b>
&nbsp;
&nbsp;    /**
&nbsp;     * See [here](https://docs.kweb.io/en/latest/dom.html#listening-for-events).
&nbsp;     *
&nbsp;     * @param retrieveJs A JavaScript expression that will be returned to the server
&nbsp;     * in [Event.retrieved] when an event fires in the browser.
&nbsp;     * @param preventDefault Whether [preventDefault()](https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)
&nbsp;     *                       will be called on the event object.
&nbsp;     */
<b class="fc">&nbsp;    fun on(retrieveJs: String? = null, preventDefault: Boolean = false) = OnReceiver(this, retrieveJs, preventDefault)</b>
&nbsp;
&nbsp;    /**
&nbsp;     * See [here](https://docs.kweb.io/en/latest/dom.html#immediate-events).
&nbsp;     */
<b class="fc">&nbsp;    val onImmediate get() = OnImmediateReceiver(this)</b>
&nbsp;}
&nbsp;
&nbsp;/**
&nbsp; * A convenience wrapper around [new] which allows a nested DSL-style syntax
&nbsp; *
&nbsp; * @param position What position among the parent&#39;s children should the new element have?
&nbsp; * @param receiver A code block in which any created elements will be children of this element.
&nbsp; */
&nbsp;fun &lt;ELEMENT_TYPE : Element, RETURN_VALUE_TYPE&gt; ELEMENT_TYPE.new(
&nbsp;    insertBefore: String? = null,
&nbsp;    receiver: ElementCreator&lt;ELEMENT_TYPE&gt;.(ELEMENT_TYPE) -&gt; RETURN_VALUE_TYPE
&nbsp;)
&nbsp;        : RETURN_VALUE_TYPE {
&nbsp;    return receiver(
&nbsp;        ElementCreator(element = this, insertBefore = insertBefore), this
&nbsp;    )
&nbsp;}
&nbsp;
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2022-11-12 04:54</div>
</div>
</body>
</html>
